deploy:
  needs: build-and-push
  runs-on: ubuntu-latest
  steps:
    - name: Deploy to VPS
      uses: appleboy/ssh-action@v1
      with:
        host: ${{ secrets.VPS_HOST }}
        username: ubuntu
        key: ${{ secrets.VPS_SSH_KEY }}
        script: |
          cd /srv/pirtolx-api
          sudo docker pull milodorosario/pirtolx-api:latest
          sudo docker compose down || true
          sudo docker compose up -d --force-recreate
